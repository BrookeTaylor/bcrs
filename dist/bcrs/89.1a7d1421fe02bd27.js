"use strict";(self.webpackChunkbcrs=self.webpackChunkbcrs||[]).push([[89],{8089:(Pe,_,l)=>{l.r(_),l.d(_,{SecurityModule:()=>Ie});var m=l(6814),u=l(9310),n=l(95),g=l(9862),e=l(4946);let f=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-security"]],decls:1,vars:0,template:function(i,s){1&i&&e._UZ(0,"router-outlet")},dependencies:[u.lC],encapsulation:2}),o})();var h=l(459);let v=(()=>{var t;class o{constructor(i){this.http=i}findUserById(i){return this.http.get("api/users/"+i)}signin(i,s){return this.http.post("/api/security/signin",{email:i,password:s})}register(i){return this.http.post("/api/security/register",{user:i})}}return(t=o).\u0275fac=function(i){return new(i||t)(e.LFG(g.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),o})();function Z(t,o){if(1&t&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&t){const r=e.oxw();e.xp6(1),e.hij(" ",r.errorMessage," ")}}function q(t,o){1&t&&(e.TgZ(0,"div")(1,"div",25),e._uU(2," Email is required. "),e._UZ(3,"input",26),e.qZA()())}function w(t,o){1&t&&(e.TgZ(0,"div")(1,"div",25),e._uU(2," Please enter a valid email address. "),e._UZ(3,"input",26),e.qZA()())}function x(t,o){1&t&&(e.TgZ(0,"div")(1,"div",25),e._uU(2," Password is required. "),e._UZ(3,"input",26),e.qZA()())}function T(t,o){1&t&&(e.TgZ(0,"div")(1,"div",25),e._uU(2," Password must be at least 8 characters and contain at least one uppercase letter, one lowercase letter, and one number "),e._UZ(3,"input",26),e.qZA()())}function b(t,o){1&t&&(e.TgZ(0,"span",27),e._uU(1,"Sign In"),e.qZA())}function F(t,o){1&t&&(e.TgZ(0,"div"),e._UZ(1,"span",28),e._uU(2,"Loading... "),e.qZA())}let A=(()=>{var t;class o{constructor(i,s,a,c,d){this.fb=i,this.router=s,this.cookieService=a,this.secService=c,this.route=d,this.isLoading=!1,this.signinForm=this.fb.group({email:[null,n.kI.compose([n.kI.required,n.kI.email])],password:[null,n.kI.compose([n.kI.required,n.kI.pattern("^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$")])]}),this.errorMessage=""}signin(){this.isLoading=!0,console.log("Sign in form: ",this.signinForm.value);let i=this.signinForm.controls.email.value,s=this.signinForm.controls.password.value;if(!i||!s)return this.errorMessage="Please provide an email address and password",this.isLoading=!1,void setTimeout(()=>{this.errorMessage=""},3e3);this.secService.signin(i,s).subscribe({next:a=>{console.log("User",a),this.cookieService.set("session_user",JSON.stringify({fullName:`${a.firstName} ${a.lastName}`,role:a.role,empId:a.empId,email:a.email}),1);const d=this.route.snapshot.queryParamMap.get("returnUrl")||"/";this.isLoading=!1,this.router.navigate([d])},error:a=>{if(this.isLoading=!1,console.log("err",a),401===a.error.status)return this.errorMessage=a.message,void setTimeout(()=>{this.errorMessage=""},3e3)}})}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(n.qu),e.Y36(u.F0),e.Y36(h.N),e.Y36(v),e.Y36(u.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-signin"]],decls:38,vars:8,consts:[[1,"container"],[1,"row","justify-content-center","m5"],[1,"col-lg-6","col-md-10","col-sm-12"],[1,"card","shadow","button-brown"],[1,"card-title","text-center"],[1,"p-3","text-light"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"card","body"],[3,"formGroup","ngSubmit"],[1,"mb-4","mt-3","input"],["for","email",1,"form-label"],["type","text","id","email","formControlName","email",1,"form-control"],[4,"ngIf"],[1,"mb-2","input"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password",1,"form-control"],[1,"text-center","mb-4"],["routerLink","/security/forgot-password",1,"text-hp","forgot-password"],[1,"d-grid"],["type","submit",1,"btn","dark-yellow"],["class","text-hp",4,"ngIf"],[1,"text-center","mt-3","mb-2"],["routerLink","/security/register",1,"text-hp"],["routerLink","/",1,"text-dark","text-underline-hover"],["role","alert",1,"alert","alert-danger"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],[1,"text-hp"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),e._uU(6,"User Sign In"),e.qZA()(),e.YNc(7,Z,2,1,"div",6),e.TgZ(8,"div",7)(9,"form",8),e.NdJ("ngSubmit",function(){return s.signin(),s.signinForm.reset()}),e.TgZ(10,"div",9)(11,"label",10),e._uU(12,"Email:"),e.qZA(),e._UZ(13,"input",11),e.qZA(),e.YNc(14,q,4,0,"div",12),e.YNc(15,w,4,0,"div",12),e.TgZ(16,"div",13)(17,"label",14),e._uU(18,"Password:"),e.qZA(),e._UZ(19,"input",15),e.qZA(),e.YNc(20,x,4,0,"div",12),e.YNc(21,T,4,0,"div",12),e.TgZ(22,"div",16)(23,"div")(24,"a",17),e._uU(25,"Forgot Password?"),e.qZA()()(),e._UZ(26,"br"),e.TgZ(27,"div",18)(28,"button",19),e.YNc(29,b,2,0,"span",20),e.YNc(30,F,3,0,"div",12),e.qZA()(),e.TgZ(31,"div",21)(32,"div"),e._uU(33,"Don't have an account? "),e.TgZ(34,"a",22),e._uU(35,"Sign up now"),e.qZA()()()()()(),e.TgZ(36,"a",23),e._uU(37,"Return"),e.qZA()()()()),2&i&&(e.xp6(7),e.Q6J("ngIf",s.errorMessage),e.xp6(2),e.Q6J("formGroup",s.signinForm),e.xp6(5),e.Q6J("ngIf",s.signinForm.controls.email.touched&&s.signinForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",s.signinForm.controls.email.touched&&s.signinForm.controls.email.hasError("email")),e.xp6(5),e.Q6J("ngIf",s.signinForm.controls.password.touched&&s.signinForm.controls.password.hasError("required")),e.xp6(1),e.Q6J("ngIf",s.signinForm.controls.password.touched&&s.signinForm.controls.password.hasError("pattern")),e.xp6(8),e.Q6J("ngIf",!s.isLoading),e.xp6(1),e.Q6J("ngIf",s.isLoading))},dependencies:[m.O5,u.rH,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u],styles:[".container[_ngcontent-%COMP%]{margin-top:3em}.button-brown[_ngcontent-%COMP%]{background-color:#372e29}.dark-yellow[_ngcontent-%COMP%]{background-color:#eeba35}.input[_ngcontent-%COMP%]{width:95%;margin:auto}.text-hp[_ngcontent-%COMP%]{color:#372e29}.forgot-password[_ngcontent-%COMP%]{float:right;margin-right:18px}"]}),o})();function C(t,o){if(1&t&&(e.TgZ(0,"div",23),e._uU(1),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.hij(" ",r.errorMessage," ")}}function N(t,o){1&t&&(e.TgZ(0,"div")(1,"div",24),e._uU(2," Email is required. "),e._UZ(3,"input",25),e.qZA()())}function U(t,o){1&t&&(e.TgZ(0,"div")(1,"div",24),e._uU(2," Please enter a valid email address. "),e._UZ(3,"input",25),e.qZA()())}function y(t,o){1&t&&(e.TgZ(0,"span",26),e._uU(1,"Continue"),e.qZA())}function I(t,o){1&t&&(e.TgZ(0,"div"),e._UZ(1,"span",27),e._uU(2,"Loading... "),e.qZA())}function P(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",6)(2,"h1",7),e._uU(3,"Password Reset"),e.qZA(),e.TgZ(4,"p",8),e._uU(5,"Forgot your password? Enter the email address that is associated with your account."),e.qZA()(),e.TgZ(6,"div",9),e.YNc(7,C,2,1,"div",10),e.TgZ(8,"form",11),e.NdJ("ngSubmit",function(){e.CHM(r);const s=e.oxw();return s.emailSubmit(),e.KtG(s.emailForm.reset())}),e.TgZ(9,"div",12)(10,"label",13),e._uU(11,"Email:"),e.qZA(),e._UZ(12,"input",14),e.qZA(),e.YNc(13,N,4,0,"div",4),e.YNc(14,U,4,0,"div",4),e.TgZ(15,"div",15)(16,"button",16),e.YNc(17,y,2,0,"span",17),e.YNc(18,I,3,0,"div",4),e.qZA()()(),e.TgZ(19,"div",18),e._UZ(20,"div",19)(21,"div",20)(22,"div",20),e.qZA()(),e.TgZ(23,"div",21),e._uU(24," Have any questions or concerns? Please reach out to "),e.TgZ(25,"a",22),e._uU(26,"support@bcrs.com"),e.qZA()()()}if(2&t){const r=e.oxw();e.xp6(7),e.Q6J("ngIf",r.errorMessage),e.xp6(1),e.Q6J("formGroup",r.emailForm),e.xp6(5),e.Q6J("ngIf",r.emailForm.controls.email.touched&&r.emailForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",r.emailForm.controls.email.touched&&r.emailForm.controls.email.hasError("email")),e.xp6(3),e.Q6J("ngIf",!r.isLoading),e.xp6(1),e.Q6J("ngIf",r.isLoading)}}function J(t,o){if(1&t&&(e.TgZ(0,"div",23),e._uU(1),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.hij(" ",r.errorMessage," ")}}function Q(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div",31)(1,"label"),e._uU(2),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"input",32),e.NdJ("ngModelChange",function(s){const c=e.CHM(r).index,d=e.oxw(2);return e.KtG(d.securityAnswers[c].answer=s)}),e.qZA()()}if(2&t){const r=o.$implicit,i=o.index,s=e.oxw(2);e.xp6(2),e.Oqu(r.question),e.xp6(2),e.Q6J("ngModel",s.securityAnswers[i].answer)}}function k(t,o){1&t&&(e.TgZ(0,"span",26),e._uU(1,"Submit"),e.qZA())}function R(t,o){1&t&&(e.TgZ(0,"div"),e._UZ(1,"span",27),e._uU(2,"Loading... "),e.qZA())}function M(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",6)(2,"h1",7),e._uU(3,"Security Questions"),e.qZA(),e.TgZ(4,"p",8),e._uU(5,"Please answer the following questions in order to gain access to your account."),e.qZA()(),e.TgZ(6,"div",9),e.YNc(7,J,2,1,"div",10),e.YNc(8,Q,5,2,"div",28),e.TgZ(9,"div",29)(10,"button",30),e.NdJ("click",function(){e.CHM(r);const s=e.oxw();return e.KtG(s.submitAnswers())}),e.YNc(11,k,2,0,"span",17),e.YNc(12,R,3,0,"div",4),e.qZA()(),e.TgZ(13,"div",18),e._UZ(14,"div",20)(15,"div",19)(16,"div",20),e.qZA()(),e.TgZ(17,"div",21),e._uU(18," Have any questions or concerns? Please reach out to "),e.TgZ(19,"a",22),e._uU(20,"support@bcrs.com"),e.qZA()()()}if(2&t){const r=e.oxw();e.xp6(7),e.Q6J("ngIf",r.errorMessage),e.xp6(1),e.Q6J("ngForOf",r.questions),e.xp6(3),e.Q6J("ngIf",!r.isLoading),e.xp6(1),e.Q6J("ngIf",r.isLoading)}}function Y(t,o){if(1&t&&(e.TgZ(0,"div",23),e._uU(1),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.hij(" ",r.errorMessage," ")}}function S(t,o){1&t&&(e.TgZ(0,"div")(1,"div",24),e._uU(2," New Password is required. "),e._UZ(3,"input",25),e.qZA()())}function L(t,o){1&t&&(e.TgZ(0,"div")(1,"div",24),e._uU(2," Confirm Password is required. "),e._UZ(3,"input",25),e.qZA()())}function E(t,o){1&t&&(e.TgZ(0,"div")(1,"div",24),e._uU(2," The password must be at least 8 characters long and contain at least one uppercase letter, one lowercase letter, and one number. "),e._UZ(3,"button",25),e.qZA()())}function O(t,o){1&t&&(e.TgZ(0,"span",26),e._uU(1,"Reset Password"),e.qZA())}function G(t,o){1&t&&(e.TgZ(0,"div"),e._UZ(1,"span",27),e._uU(2,"Loading... "),e.qZA())}function j(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",6)(2,"h1",7),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"p",8),e._uU(5,"Please reset your password."),e.qZA()(),e.TgZ(6,"div",9),e.YNc(7,Y,2,1,"div",10),e.TgZ(8,"form",11),e.NdJ("ngSubmit",function(){e.CHM(r);const s=e.oxw();return e.KtG(s.resetPassword())}),e.TgZ(9,"div",12)(10,"label",33),e._uU(11,"New Password:"),e.qZA(),e._UZ(12,"input",34),e.qZA(),e.TgZ(13,"div",35)(14,"label",36),e._uU(15,"Confirm Password:"),e.qZA(),e._UZ(16,"input",37),e.qZA(),e.YNc(17,S,4,0,"div",4),e.YNc(18,L,4,0,"div",4),e.YNc(19,E,4,0,"div",4),e.TgZ(20,"div",15)(21,"button",16),e.YNc(22,O,2,0,"span",17),e.YNc(23,G,3,0,"div",4),e.qZA()()(),e.TgZ(24,"div",18),e._UZ(25,"div",20)(26,"div",20)(27,"div",19),e.qZA()(),e.TgZ(28,"div",21),e._uU(29," Have any questions or concerns? Please reach out to "),e.TgZ(30,"a",22),e._uU(31,"support@bcrs.com"),e.qZA()()()}if(2&t){const r=e.oxw();e.xp6(7),e.Q6J("ngIf",r.errorMessage),e.xp6(1),e.Q6J("formGroup",r.passwordResetForm),e.xp6(9),e.Q6J("ngIf",r.passwordResetForm.controls.password.touched&&r.passwordResetForm.controls.password.hasError("required")),e.xp6(1),e.Q6J("ngIf",r.passwordResetForm.controls.confirmPassword.touched&&r.passwordResetForm.controls.confirmPassword.hasError("required")),e.xp6(1),e.Q6J("ngIf",r.passwordResetForm.controls.password.touched&&r.passwordResetForm.controls.password.hasError("pattern")),e.xp6(3),e.Q6J("ngIf",!r.isLoading),e.xp6(1),e.Q6J("ngIf",r.isLoading)}}let B=(()=>{var t;class o{next(i){this.step=i}constructor(i,s,a){this.formBuilder=i,this.http=s,this.router=a,this.passwordResetForm=this.formBuilder.group({password:["",[n.kI.required,n.kI.pattern("^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$")]],confirmPassword:["",[n.kI.required]]}),this.isLoading=!1,this.email="",this.step="start",this.questions=[],this.securityAnswers=[],this.errorMessage="",this.emailForm=this.formBuilder.group({email:["",[n.kI.required,n.kI.email]]}),this.securityAnswers=[{question:"",answer:""},{question:"",answer:""},{question:"",answer:""}]}ngOnInit(){}emailSubmit(){if(this.emailForm.invalid)return this.errorMessage="Please enter a valid email address.",void setTimeout(()=>{this.errorMessage=""},3e3);this.isLoading=!0;const i=this.emailForm.get("email")?.value;this.email=i,this.http.get(`/api/users/${i}/security-questions`,{}).subscribe(s=>{0===s.selectedSecurityQuestions.length?(this.errorMessage="User doesn't have security questions selected. Please contact the system administrator.",this.isLoading=!1):(this.questions=s.selectedSecurityQuestions,this.securityAnswers=this.questions.map(a=>({question:a.question,answer:""})),this.step="security",this.isLoading=!1)},s=>{this.errorMessage="User not found. Please check your email address.",setTimeout(()=>{this.errorMessage=""},3e3),this.isLoading=!1})}submitAnswers(){const i=this.email;this.isLoading=!0;let s=!1;for(const d of this.securityAnswers)if(!d.answer){s=!0;break}if(s)return this.errorMessage="All fields must be completed.",this.isLoading=!1,void setTimeout(()=>{this.errorMessage=""},3e3);const a={email:i,securityQuestions:this.securityAnswers},c=new g.WM({"Content-Type":"application/json"});this.http.post(`/api/security/verify/users/${i}/security-questions`,a,{headers:c}).subscribe(d=>{console.log("Security questions matched:",d),this.step="reset",this.isLoading=!1},d=>{console.error("Security questions did not match:"),this.errorMessage="Security questions did not match.",this.isLoading=!1,setTimeout(()=>{this.errorMessage=""},3e3)})}resetPassword(){if(this.passwordResetForm.invalid)return this.errorMessage="Please fill out both password fields.",void setTimeout(()=>{this.errorMessage=""},3e3);this.isLoading=!0;const i=this.passwordResetForm.get("password")?.value,s=this.passwordResetForm.get("confirmPassword")?.value;if(i!==s)return this.isLoading=!1,this.errorMessage="The Passwords do not match.",void setTimeout(()=>{this.errorMessage=""},3e3);const a={password:i},c=this.email,d=new g.WM({"Content-Type":"application/json"});this.http.delete(`/api/security/users/${c}/reset-password`,{headers:d,body:a}).subscribe(p=>{this.isLoading=!1,console.log("Password reset successfully:",p),this.router.navigate(["/security/signin"])},p=>{console.error("Password reset failed:",p)})}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(n.qu),e.Y36(g.eN),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-forgot-password"]],decls:9,vars:3,consts:[[1,"container"],[1,"row","justify-content-center","m5"],[1,"col-lg-6","col-md-10","col-sm-12"],[1,"card","shadow"],[4,"ngIf"],["routerLink","/",1,"text-dark","text-underline-hover","p-3"],[1,"card-title","text-center"],[1,"p-3"],[1,"text-start","p-3"],[1,"m-5"],["class","alert alert-danger","role","alert",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mb-4","mt-3","input"],["for","email",1,"form-label"],["type","text","id","email","formControlName","email",1,"form-control"],[1,"d-grid"],["type","submit",1,"btn","text-light","brown"],["class","text-hp",4,"ngIf"],[1,"indicator"],[1,"dot","active"],[1,"dot"],[1,"card-footer","p-3"],["href","mailto:support@bcrs.com"],["role","alert",1,"alert","alert-danger"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],[1,"text-hp"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["class","p-2",4,"ngFor","ngForOf"],[1,"d-grid","mt-3"],["type","button",1,"btn","text-light","brown",3,"click"],[1,"p-2"],["type","text",3,"ngModel","ngModelChange"],["for","password"],["type","password","id","password","formControlName","password",1,"form-control"],[1,"mb-4","input"],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword",1,"form-control"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,P,27,6,"div",4),e.YNc(5,M,21,4,"div",4),e.YNc(6,j,32,7,"div",4),e.qZA(),e.TgZ(7,"a",5),e._uU(8,"Return"),e.qZA()()()()),2&i&&(e.xp6(4),e.Q6J("ngIf","start"===s.step),e.xp6(1),e.Q6J("ngIf","security"===s.step),e.xp6(1),e.Q6J("ngIf","reset"===s.step))},dependencies:[m.sg,m.O5,u.rH,n._Y,n.Fj,n.JJ,n.JL,n.On,n.sg,n.u],styles:[".card[_ngcontent-%COMP%]{margin-top:3em;border-radius:15px}.card-title[_ngcontent-%COMP%]{background-color:#372e29;border-radius:15px 15px 0 0;color:#fff}.brown[_ngcontent-%COMP%]{background-color:#372e29}.card-footer[_ngcontent-%COMP%]{background-color:#ffd25f;border-radius:0 0 15px 15px}.indicator[_ngcontent-%COMP%]{margin-top:1.5em;display:flex;justify-content:center}.dot[_ngcontent-%COMP%]{width:12px;height:12px;border:2px solid #372e29;border-radius:50%;margin:0 4px}.dot.active[_ngcontent-%COMP%]{background-color:#372e29}"]}),o})();function H(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," First Name is Required"),e.qZA())}function $(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,H,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.firstName.hasError("required"))}}function z(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Last Name is Required"),e.qZA())}function K(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,z,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.lastName.hasError("required"))}}function W(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Phone Number is Required"),e.qZA())}function X(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Phone Number must be a number. "),e.qZA())}function D(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,W,2,0,"div",5),e.YNc(2,X,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.phoneNumber.hasError("required")),e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.phoneNumber.hasError("pattern"))}}function V(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Address is Required"),e.qZA())}function ee(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,V,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.address.hasError("required"))}}function te(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",7)(2,"h1",8),e._uU(3,"User Information"),e.qZA(),e.TgZ(4,"p",9),e._uU(5,"Please provide your information."),e.qZA()(),e.TgZ(6,"div",10)(7,"div",11)(8,"div",12)(9,"label",13),e._uU(10,"First Name:"),e.qZA(),e._UZ(11,"input",14),e.YNc(12,$,2,1,"div",15),e.qZA(),e.TgZ(13,"div",12)(14,"label",16),e._uU(15,"Last Name:"),e.qZA(),e._UZ(16,"input",17),e.YNc(17,K,2,1,"div",15),e.qZA()(),e.TgZ(18,"div",18)(19,"div",12)(20,"label",19),e._uU(21,"Phone Number:"),e.qZA(),e._UZ(22,"input",20),e.YNc(23,D,3,2,"div",15),e.qZA(),e.TgZ(24,"div",12)(25,"label",21),e._uU(26,"Address:"),e.qZA(),e._UZ(27,"input",22),e.YNc(28,ee,2,1,"div",15),e.qZA()(),e.TgZ(29,"div",23)(30,"button",24),e.NdJ("click",function(){e.CHM(r);const s=e.oxw();return e.KtG(s.next("secQ"))}),e.TgZ(31,"span",25),e._uU(32,"Continue"),e.qZA()()(),e.TgZ(33,"div",26)(34,"button",27)(35,"span",25),e._uU(36,"Go Back"),e.qZA()()(),e.TgZ(37,"div",28),e._UZ(38,"div",29)(39,"div",30)(40,"div",30),e.qZA()(),e.TgZ(41,"div",31),e._uU(42," Have any questions or concerns? Please reach out to "),e.TgZ(43,"a",32),e._uU(44,"support@bcrs.com"),e.qZA()()()}if(2&t){const r=e.oxw();e.xp6(12),e.Q6J("ngIf",r.registerForm.controls.firstName.invalid&&(r.registerForm.controls.firstName.dirty||r.registerForm.controls.firstName.touched)),e.xp6(5),e.Q6J("ngIf",r.registerForm.controls.lastName.invalid&&(r.registerForm.controls.lastName.dirty||r.registerForm.controls.lastName.touched)),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.phoneNumber.invalid&&(r.registerForm.controls.phoneNumber.dirty||r.registerForm.controls.phoneNumber.touched)),e.xp6(5),e.Q6J("ngIf",r.registerForm.controls.address.invalid&&(r.registerForm.controls.address.dirty||r.registerForm.controls.address.touched)),e.xp6(2),e.Q6J("disabled",!r.personalRequired())}}function re(t,o){if(1&t&&(e.TgZ(0,"option",49),e._uU(1),e.qZA()),2&t){const r=o.$implicit;e.Q6J("value",r),e.xp6(1),e.Oqu(r)}}function oe(t,o){1&t&&(e.TgZ(0,"div",33),e._uU(1," Question is required. "),e.qZA())}function ie(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1,"Answer is required. "),e.qZA())}function se(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,ie,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.answer1.hasError("required"))}}function ne(t,o){if(1&t&&(e.TgZ(0,"option",49),e._uU(1),e.qZA()),2&t){const r=o.$implicit;e.Q6J("value",r),e.xp6(1),e.Oqu(r)}}function ae(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Question is required. "),e.qZA())}function de(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,ae,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.question2.hasError("required"))}}function ce(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Answer is required. "),e.qZA())}function ue(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,ce,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.answer2.hasError("required"))}}function le(t,o){if(1&t&&(e.TgZ(0,"option",49),e._uU(1),e.qZA()),2&t){const r=o.$implicit;e.Q6J("value",r),e.xp6(1),e.Oqu(r)}}function me(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Question is required. "),e.qZA())}function ge(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,me,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.question3.hasError("required"))}}function pe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Answer is required. "),e.qZA())}function _e(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,pe,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.answer3.hasError("required"))}}function ve(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",7)(2,"h1",8),e._uU(3,"Security Questions"),e.qZA(),e.TgZ(4,"p",9),e._uU(5,"Please answer some security questions."),e.qZA()(),e.TgZ(6,"div",10)(7,"div",11)(8,"div")(9,"label",34),e._uU(10,"Question:"),e.qZA(),e.TgZ(11,"select",35),e.YNc(12,re,2,2,"option",36),e.qZA(),e.YNc(13,oe,2,0,"div",15),e.qZA()(),e.TgZ(14,"div",11)(15,"div")(16,"label",37),e._uU(17,"Answer:"),e.qZA(),e._UZ(18,"input",38),e.YNc(19,se,2,1,"div",15),e.qZA()(),e.TgZ(20,"div",39)(21,"div")(22,"label",40),e._uU(23,"Question"),e.qZA(),e.TgZ(24,"select",41),e.YNc(25,ne,2,2,"option",36),e.qZA(),e.YNc(26,de,2,1,"div",15),e.qZA()(),e.TgZ(27,"div",11)(28,"div")(29,"label",42),e._uU(30,"Answer:"),e.qZA(),e._UZ(31,"input",43),e.YNc(32,ue,2,1,"div",15),e.qZA()(),e.TgZ(33,"div",39)(34,"div")(35,"label",44),e._uU(36,"Question"),e.qZA(),e.TgZ(37,"select",45),e.YNc(38,le,2,2,"option",36),e.qZA(),e.YNc(39,ge,2,1,"div",15),e.qZA()(),e.TgZ(40,"div",11)(41,"div")(42,"label",46),e._uU(43,"Answer:"),e.qZA(),e._UZ(44,"input",47),e.YNc(45,_e,2,1,"div",15),e.qZA()(),e.TgZ(46,"div",23)(47,"button",24),e.NdJ("click",function(){e.CHM(r);const s=e.oxw();return e.KtG(s.next("userSet"))}),e.TgZ(48,"span",25),e._uU(49,"Continue"),e.qZA()()(),e.TgZ(50,"div",26)(51,"button",48),e.NdJ("click",function(){e.CHM(r);const s=e.oxw();return e.KtG(s.next("start"))}),e.TgZ(52,"span",25),e._uU(53,"Go Back"),e.qZA()()(),e.TgZ(54,"div",28),e._UZ(55,"div",30)(56,"div",29)(57,"div",30),e.qZA()(),e.TgZ(58,"div",31),e._uU(59," Have any questions or concerns? Please reach out to "),e.TgZ(60,"a",32),e._uU(61,"support@bcrs.com"),e.qZA()()()}if(2&t){const r=e.oxw();e.xp6(12),e.Q6J("ngForOf",r.qArr1),e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.question1.invalid&&(r.registerForm.controls.question1.dirty||r.registerForm.controls.question1.touched)),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.answer1.invalid&&(r.registerForm.controls.answer1.dirty||r.registerForm.controls.answer1.touched)),e.xp6(6),e.Q6J("ngForOf",r.qArr2),e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.question2.invalid&&(r.registerForm.controls.question2.dirty||r.registerForm.controls.question2.touched)),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.answer2.invalid&&(r.registerForm.controls.answer2.dirty||r.registerForm.controls.answer2.touched)),e.xp6(6),e.Q6J("ngForOf",r.qArr3),e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.question3.invalid&&(r.registerForm.controls.question3.dirty||r.registerForm.controls.question3.touched)),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.answer3.invalid&&(r.registerForm.controls.answer3.dirty||r.registerForm.controls.answer3.touched)),e.xp6(2),e.Q6J("disabled",!r.questionsRequired())}}function fe(t,o){if(1&t&&(e.TgZ(0,"div",11)(1,"div",59)(2,"div",60),e._uU(3),e.qZA()()()),2&t){const r=e.oxw(2);e.xp6(3),e.hij(" ",r.errorMessage," ")}}function he(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1,"Email is Required"),e.qZA())}function Ze(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Must be a valid email address. "),e.qZA())}function qe(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,he,2,0,"div",5),e.YNc(2,Ze,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.email.hasError("email"))}}function we(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Password is Required"),e.qZA())}function xe(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Password must be at least 8 characters and contain at least one uppercase letter, one lowercase letter, and one number. "),e.qZA())}function Te(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,we,2,0,"div",5),e.YNc(2,xe,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.password.hasError("required")),e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.password.hasError("pattern"))}}function be(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," Confirm Password is Required"),e.qZA())}function Fe(t,o){if(1&t&&(e.TgZ(0,"div",33),e.YNc(1,be,2,0,"div",5),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",r.registerForm.controls.confirmPassword.hasError("required"))}}function Ae(t,o){1&t&&(e.TgZ(0,"span",25),e._uU(1,"Continue"),e.qZA())}function Ce(t,o){1&t&&(e.TgZ(0,"div"),e._UZ(1,"span",61),e._uU(2,"Loading... "),e.qZA())}function Ne(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",7)(2,"h1",8),e._uU(3,"User Set"),e.qZA(),e.TgZ(4,"p",9),e._uU(5,"Please provide your email and create a password."),e.qZA()(),e.TgZ(6,"div",10),e.YNc(7,fe,4,1,"div",50),e.TgZ(8,"div",11)(9,"div")(10,"label",51),e._uU(11,"Email:"),e.qZA(),e._UZ(12,"input",52),e.YNc(13,qe,3,2,"div",15),e.qZA()(),e.TgZ(14,"div",18)(15,"div")(16,"label",53),e._uU(17,"Password:"),e.qZA(),e._UZ(18,"input",54),e.YNc(19,Te,3,2,"div",15),e.qZA()(),e.TgZ(20,"div",11)(21,"div")(22,"label",55),e._uU(23,"Confirm Password:"),e.qZA(),e._UZ(24,"input",56),e.YNc(25,Fe,2,1,"div",15),e.qZA()(),e.TgZ(26,"div",23)(27,"button",57),e.YNc(28,Ae,2,0,"span",58),e.YNc(29,Ce,3,0,"div",5),e.qZA()(),e.TgZ(30,"div",26)(31,"button",48),e.NdJ("click",function(){e.CHM(r);const s=e.oxw();return e.KtG(s.next("secQ"))}),e.TgZ(32,"span",25),e._uU(33,"Go Back"),e.qZA()()(),e.TgZ(34,"div",28),e._UZ(35,"div",30)(36,"div",30)(37,"div",29),e.qZA()(),e.TgZ(38,"div",31),e._uU(39," Have any questions or concerns? Please reach out to "),e.TgZ(40,"a",32),e._uU(41,"support@bcrs.com"),e.qZA()()()}if(2&t){const r=e.oxw();e.xp6(7),e.Q6J("ngIf",r.errorMessage),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.email.invalid&&(r.registerForm.controls.email.dirty||r.registerForm.controls.email.touched)),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.password.invalid&&(r.registerForm.controls.password.dirty||r.registerForm.controls.password.touched)),e.xp6(6),e.Q6J("ngIf",r.registerForm.controls.confirmPassword.invalid&&(r.registerForm.controls.confirmPassword.dirty||r.registerForm.controls.confirmPassword.touched)),e.xp6(2),e.Q6J("disabled",!r.registerForm.valid),e.xp6(1),e.Q6J("ngIf",!r.isLoading),e.xp6(1),e.Q6J("ngIf",r.isLoading)}}const Ue=[{path:"",component:f,children:[{path:"signin",component:A,title:"BCRS Sign in"},{path:"register",component:(()=>{var t;class o{next(i){this.step=i}personalRequired(){const i=this.registerForm.get("firstName")?.value,s=this.registerForm.get("lastName")?.value,a=this.registerForm.get("phoneNumber")?.value,c=this.registerForm.get("address")?.value;return!!(i&&s&&a&&c)}questionsRequired(){const i=this.registerForm.get("question1")?.value,s=this.registerForm.get("answer1")?.value,a=this.registerForm.get("question2")?.value,c=this.registerForm.get("question2")?.value,d=this.registerForm.get("question3")?.value,p=this.registerForm.get("answer3")?.value;return!!(i&&s&&a&&c&&d&&p)}constructor(i,s,a){this.router=i,this.fb=s,this.securityService=a,this.step="start",this.isLoading=!1,this.registerForm=this.fb.group({firstName:[null,n.kI.compose([n.kI.required])],lastName:[null,n.kI.compose([n.kI.required])],email:[null,n.kI.compose([n.kI.required,n.kI.email])],password:[null,n.kI.compose([n.kI.required,n.kI.pattern("^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$")])],confirmPassword:["",[n.kI.required]],phoneNumber:[null,n.kI.compose([n.kI.required,n.kI.pattern("^[0-9]*$")])],address:[null,n.kI.compose([n.kI.required,n.kI.required])],question1:[null,n.kI.compose([n.kI.required])],answer1:[null,n.kI.compose([n.kI.required])],question2:[null,n.kI.compose([n.kI.required])],answer2:[null,n.kI.compose([n.kI.required])],question3:[null,n.kI.compose([n.kI.required])],answer3:[null,n.kI.compose([n.kI.required])]}),this.securityQuestions=["What is your mother's maiden name?","What is the name of your first pet?","What is your favorite color?","What is your favorite movie?","What is your favorite food?","What is your favorite song?"],this.qArr1=this.securityQuestions,this.qArr2=[],this.qArr3=[],this.user={},this.errorMessage=""}ngOnInit(){this.registerForm.get("question1")?.valueChanges.subscribe(i=>{console.log("Value changed from question 1",i),this.qArr2=this.qArr1.filter(s=>s!==i)}),this.registerForm.get("question2")?.valueChanges.subscribe(i=>{console.log("Value changed from Question 2",i),this.qArr3=this.qArr2.filter(s=>s!==i)})}register(){this.isLoading=!0,this.user={firstName:this.registerForm.get("firstName")?.value,lastName:this.registerForm.get("lastName")?.value,email:this.registerForm.get("email")?.value,password:this.registerForm.get("password")?.value,phoneNumber:parseInt(this.registerForm.get("phoneNumber")?.value,10),address:this.registerForm.get("address")?.value,selectedSecurityQuestions:[{question:this.registerForm.get("question1")?.value,answer:this.registerForm.get("answer1")?.value},{question:this.registerForm.get("question2")?.value,answer:this.registerForm.get("answer2")?.value},{question:this.registerForm.get("question3")?.value,answer:this.registerForm.get("answer3")?.value}]};const i=this.registerForm.get("password")?.value,s=this.registerForm.get("confirmPassword")?.value;if(i!==s)return this.isLoading=!1,this.errorMessage="The Passwords do not match.",void setTimeout(()=>{this.errorMessage=""},3e3);console.log("Registering new user",this.user),this.securityService.register(this.user).subscribe({next:a=>{this.isLoading=!1,console.log("Result from Register API call: ",a),this.router.navigate(["/security/signin"])},error:a=>{a.error.message?(console.log("db error: ",a.error.message),this.errorMessage=a.error.message,this.isLoading=!1):(this.errorMessage="Something went wrong. Please contact the system administrator",console.log(a),this.isLoading=!1)}})}}return(t=o).\u0275fac=function(i){return new(i||t)(e.Y36(u.F0),e.Y36(n.qu),e.Y36(v))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-register"]],decls:10,vars:4,consts:[[1,"container"],[1,"row","justify-content-center","m5"],[1,"col-lg-6","col-md-10","col-sm-12"],[1,"card","shadow"],[1,"form","row","g-3",3,"formGroup","ngSubmit"],[4,"ngIf"],["routerLink","/",1,"text-dark","text-underline-hover","p-3"],[1,"card-title","text-center"],[1,"p-3"],[1,"text-start","p-3"],[1,"m-5"],[1,"row"],[1,"col-md-6"],["for","firstName",1,"form-label"],["formControlName","firstName","type","text","id","firstName","name","firstName","required","",1,"form-control"],["class","alert alert-danger mt-2",4,"ngIf"],["for","lastName",1,"form-label"],["formControlName","lastName","type","text","id","lastName","name","lastName","required","",1,"form-control"],[1,"row","mt-3"],["for","phoneNumber",1,"form-label"],["formControlName","phoneNumber","type","text","id","phoneNumber","name","phoneNumber","required","",1,"form-control"],["for","address",1,"form-label"],["formControlName","address","type","text","id","address","name","address","required","",1,"form-control"],[1,"d-grid","mt-5"],[1,"btn","text-light","brown",3,"disabled","click"],[1,"text-hp"],[1,"d-grid","mt-3"],["a","","routerLink","/security/signin",1,"btn","text-light","goBack"],[1,"indicator"],[1,"dot","active"],[1,"dot"],[1,"card-footer","p-3"],["href","mailto:support@bcrs.com"],[1,"alert","alert-danger","mt-2"],["for","q1"],["name","q1","id","q1","formControlName","question1",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["for","a1"],["type","text","id","a1","formControlName","answer1","name","a1","required","",1,"form-control","answer"],[1,"row","mt-5"],["for","q2"],["name","q2","id","q2","formControlName","question2",1,"form-select"],["for","a2"],["type","text","id","a2","formControlName","answer2","name","a2","required","",1,"form-control","answer"],["for","q3"],["name","q3","id","q3","formControlName","question3",1,"form-select"],["for","a3"],["type","text","id","a3","formControlName","answer3","name","a3","required","",1,"form-control","answer"],[1,"btn","text-light","goBack",3,"click"],[3,"value"],["class","row",4,"ngIf"],["for","email",1,"form-label"],["formControlName","email","type","text","id","email","name","email","required","",1,"form-control","userSet"],["for","password",1,"form-label"],["formControlName","password","type","password","id","password","name","password","required","",1,"form-control"],["for","confirmPassword",1,"form-label"],["formControlName","confirmPassword","type","password","id","confirmPassword","name","confirmPassword","required","",1,"form-control"],["type","submit","id","submit","value","Register Account",1,"btn","text-light","brown",3,"disabled"],["class","text-hp",4,"ngIf"],[1,"col-12"],[1,"alert","alert-danger"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),e.NdJ("ngSubmit",function(){return s.register()}),e.YNc(5,te,45,5,"div",5),e.YNc(6,ve,62,10,"div",5),e.YNc(7,Ne,42,7,"div",5),e.qZA()(),e.TgZ(8,"a",6),e._uU(9,"Return"),e.qZA()()()()),2&i&&(e.xp6(4),e.Q6J("formGroup",s.registerForm),e.xp6(1),e.Q6J("ngIf","start"===s.step),e.xp6(1),e.Q6J("ngIf","secQ"===s.step),e.xp6(1),e.Q6J("ngIf","userSet"===s.step))},dependencies:[m.sg,m.O5,u.rH,n._Y,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.JL,n.Q7,n.sg,n.u],styles:[".card[_ngcontent-%COMP%]{margin-top:3em;border-radius:15px}.card-title[_ngcontent-%COMP%]{background-color:#372e29;border-radius:15px 15px 0 0;color:#fff}.brown[_ngcontent-%COMP%]{background-color:#372e29}.goBack[_ngcontent-%COMP%]{background-color:#7d685d}.card-footer[_ngcontent-%COMP%]{background-color:#ffd25f;border-radius:0 0 15px 15px}.indicator[_ngcontent-%COMP%]{margin-top:1.5em;display:flex;justify-content:center}.dot[_ngcontent-%COMP%]{width:12px;height:12px;border:2px solid #372e29;border-radius:50%;margin:0 4px}.dot.active[_ngcontent-%COMP%]{background-color:#372e29}"]}),o})(),title:"BCRS Register"}]},{path:"forgot-password",component:B,title:"Forgot Password Process"}];let ye=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(Ue),u.Bz]}),o})(),Ie=(()=>{var t;class o{}return(t=o).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.ez,ye,u.Bz,n.u5,n.UX,g.JF]}),o})()}}]);